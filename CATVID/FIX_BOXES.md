# Решение проблемы "не покупаются ящики"

## Проблемы и решения:

### 1. Отсутствие ящиков в базе данных
**Решение:** Создать ящики через Django shell

```bash
cd CATVID
python manage.py shell
```

Затем выполнить:
```python
exec(open('create_boxes_simple.py').read())
```

Или использовать команду:
```bash
python manage.py create_boxes
```

### 2. Проблемы с авторизацией
**Исправлено:** Убран декоратор @login_required из функции buy_box, добавлена поддержка анонимных пользователей

### 3. Отладка проблем
**Добавлено:**
- Отладочная информация в JavaScript (консоль браузера)
- Отладочная информация в Python (логи сервера)
- Тестовая страница: `/test-boxes/`

## Как проверить:

1. **Откройте консоль браузера** (F12 → Console)
2. **Попробуйте купить ящик** и посмотрите на сообщения в консоли
3. **Проверьте логи сервера** Django на наличие DEBUG сообщений
4. **Используйте тестовую страницу** `/test-boxes/` для диагностики

## Возможные ошибки:

### "Ящик не найден"
- Проверьте, есть ли ящики в базе данных
- Выполните создание ящиков

### "Игрок не найден"
- Проверьте, создается ли профиль игрока при загрузке главной страницы
- Убедитесь, что в сессии есть player_id

### "Недостаточно монет"
- Проверьте, что у игрока достаточно монет для покупки
- Базовый ящик стоит 100 монет, премиум - 300

## Быстрое решение:

1. Создайте ящики:
```bash
cd CATVID
python manage.py shell < create_boxes_simple.py
```

2. Перезапустите сервер:
```bash
python manage.py runserver
```

3. Откройте игру и попробуйте купить ящик

4. Если не работает, откройте `/test-boxes/` и проверьте консоль браузера